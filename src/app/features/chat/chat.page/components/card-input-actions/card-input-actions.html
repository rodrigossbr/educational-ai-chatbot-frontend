<form
  [formGroup]="form"
  class="card-input-form"
  [class.is-recording]="activatedMic"
>
  <mat-form-field
    appearance="outline"
  >
    <input
      #msgInput
      formControlName="msg"
      matInput
      aria-label="Digite sua mensagem."
      [placeholder]="activatedMic ? 'ðŸŽ™ï¸ Gravandoâ€¦ fale que eu digito' : 'Digite sua mensagem...'"
      (keyup.enter)="sendTextMsg()"
    >
  </mat-form-field>

  <div class="card-input-form-actions">
    <button
      matIconButton type="button"
      (mousedown)="startRecord($event)"
      (mouseup)="stopRecord($event)"
      (touchstart)="startRecord($event)"
      (touchend)="stopRecord($event)"
      (touchcancel)="stopRecord($event)"
      (keydown.enter)="startRecord($event)"
      (keyup.enter)="stopRecord($event)"
      [class.recording]="activatedMic"
      [attr.aria-pressed]="activatedMic"
      [attr.aria-label]="activatedMic ? 'Gravando, solte para parar' : 'Segure para falar'"
      [disabled]="loading"
    >
      <mat-icon class="material-symbols-outlined">mic</mat-icon>
      @if (activatedMic) {
        <span class="rec-dot" aria-hidden="true"></span>
      }
    </button>
    <button
      matIconButton
      type="button"
      aria-label="Clique para enviar ou pressione enter."
      [disabled]="activatedMic || loading"
      (click)="sendTextMsg()"
    >
      <mat-icon class="material-symbols-outlined">play_arrow</mat-icon>
    </button>
  </div>
</form>

@if (activatedMic) {
  <div class="rec-visual" aria-live="polite">
    <div class="bars" aria-hidden="true">
      <span></span>
      <span></span>
      <span></span>
      <span></span>
      <span></span>
      <span></span>
      <span></span>
      <span></span>
      <span></span>
      <span></span>
    </div>
    <span class="rec-text">Gravandoâ€¦</span>
  </div>
}
